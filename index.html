<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NI Adaptive Website Demo</title>
    <!-- Using Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Custom NI colors */
        :root {
            --ni-blue: #003c71;
            --ni-green: #9fcd3a;
            --ni-dark-blue: #002f5a;
            --ni-light-gray: #f8f9fa;
        }
        body {
            font-family: 'Inter', sans-serif;
            color: #1a202c;
        }
        .ni-bg-blue { background-color: var(--ni-blue); }
        .ni-text-blue { color: var(--ni-blue); }
        .ni-bg-dark-blue { background-color: var(--ni-dark-blue); }
        .ni-text-dark-blue { color: var(--ni-dark-blue); }
        
        .ni-bg-green { background-color: var(--ni-green); }
        .ni-text-green { color: var(--ni-green); }
        .ni-border-green { border-color: var(--ni-green); }
        
        .ni-bg-light-gray { background-color: var(--ni-light-gray); }

        /* Header link style */
        .header-link {
            @apply py-6 border-b-4 border-transparent text-gray-700 font-medium;
            @apply hover:border-b-4 hover:border-ni-green hover:text-black;
        }
        
        /* Chat bubble styles */
        .chat-bubble {
            max-width: 80%;
            padding: 0.75rem 1rem;
            border-radius: 1rem;
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }
        .chat-bubble-agent {
            background-color: #f0f4f8;
            color: #1a202c;
            border-bottom-left-radius: 0.25rem;
            align-self: flex-start;
        }
        .chat-bubble-user {
            background-color: var(--ni-blue);
            color: white;
            border-bottom-right-radius: 0.25rem;
            align-self: flex-end;
        }
        
        /* Chat options button styles */
        .chat-option {
            background-color: white;
            border: 1px solid var(--ni-blue);
            color: var(--ni-blue);
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            margin: 0.25rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        .chat-option:hover {
            background-color: var(--ni-blue);
            color: white;
        }
        
        /* Pulsing button */
        .pulse-button {
            box-shadow: 0 0 0 0 rgba(159, 205, 58, 0.7);
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(159, 205, 58, 0.7);
            }
            70% {
                box-shadow: 0 0 0 12px rgba(159, 205, 58, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(159, 205, 58, 0);
            }
        }
    </style>
</head>
<body class="bg-white">

    <!--
      HEADER: High-fidelity NI Navigation Bar
    -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <!-- Logo -->
                <div class="flex-shrink-0 flex items-center">
                    <a href="#">
                        <svg class="h-8 w-auto" viewBox="0 0 340 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M37.701 100V0H0V100H37.701ZM14.138 86.862V13.138H23.563V86.862H14.138Z" fill="#003C71"/>
                            <path d="M54.1378 100V0H91.8388V13.1379H68.2758V43.431H91.8388V56.569H68.2758V86.8621H91.8388V100H54.1378Z" fill="#003C71"/>
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M110.05 0H147.751V100H110.05V0ZM124.188 13.1379V86.8621H133.613V13.1379H124.188Z" fill="#003C71"/>
                            <path d="M211.53 79.549L230.379 0H245.516L218.421 100H198.549L171.454 0H186.591L205.44 79.549H211.53Z" fill="#003C71"/>
                            <path d="M261.942 100V0H300.731C322.459 0 339.297 16.838 339.297 38.5659V61.4341C339.297 83.162 322.459 100 300.731 100H261.942ZM276.08 13.1379V86.8621H300.731C314.545 86.8621 325.16 76.2478 325.16 61.4341V38.5659C325.16 23.7522 314.545 13.1379 300.731 13.1379H276.08Z" fill="#003C71"/>
                        </svg>
                    </a>
                </div>
                
                <!-- Nav Links -->
                <div class="hidden lg:flex lg:space-x-8">
                    <a href="#" class="header-link">Solutions</a>
                    <a href="#" class="header-link">Products</a>
                    <a href="#" class="header-link">Industries</a>
                    <a href="#" class="header-link">Shop</a>
                    <a href="#" class="header-link">Support</a>
                    <a href="#" class="header-link">Company</a>
                </div>
                
                <!-- Right Icons -->
                <div class="flex items-center space-x-4">
                    <button class="text-gray-600 hover:text-black">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                    </button>
                    <button class="text-gray-600 hover:text-black">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                    </button>
                    <button class="text-gray-600 hover:text-black">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" /></svg>
                    </button>
                    <!-- Hamburger Menu (Mobile) -->
                    <button class="lg:hidden text-gray-600 hover:text-black">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!--
      PAGE CONTENT: High-fidelity replica
    -->
    <main>
        <!-- 
          HERO SECTION
          This is what we will personalize for Raj.
        -->
        <section id="hero-section" class="relative bg-white text-center">
            <!-- Background Image -->
            <img src="https://placehold.co/1600x600/003c71/FFFFFF?text=NI+Hero+Image" alt="NI Hero" class="w-full h-[500px] object-cover">
            
            <!-- Overlay Content -->
            <div class="absolute inset-0 flex flex-col items-center justify-center bg-black bg-opacity-30 p-8">
                <!-- STEP 1 & 2: Personalized Content -->
                <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-4 shadow-lg" id="hero-headline">
                    Accelerate Your EV Battery Validation
                </h1>
                <p class="text-lg md:text-xl text-white max-w-2xl mb-8 shadow-lg" id="hero-subhead">
                    Design and deploy comprehensive test systems for every stage of the battery lifecycle, from R&D to production.
                </p>
                <a href="#" class="ni-bg-green text-black font-bold py-3 px-8 rounded-full text-lg hover:opacity-90 transition-opacity">
                    Explore EV Test Solutions
                </a>
            </div>
        </section>


        <!-- Featured Solutions Section -->
        <section class="py-16 ni-bg-light-gray">
            <div class="container mx-auto px-6 lg:px-8">
                <h2 class="text-3xl font-bold text-center ni-text-dark-blue mb-12">Test and Measurement Solutions</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <!-- Solution 1: Personalized for EV -->
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden border-2 ni-border-green">
                        <div class="p-6">
                            <h3 class="text-xl font-semibold ni-text-blue mb-3">EV Battery Test</h3>
                            <p class="text-gray-600 mb-4">Validate performance and reliability for all your battery test needs.</p>
                            <a href="#" class="font-medium ni-text-blue hover:underline">Learn More &rarr;</a>
                        </div>
                    </div>
                    <!-- Solution 2 -->
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                        <div class="p-6">
                            <h3 class="text-xl font-semibold ni-text-blue mb-3">Semiconductor Test</h3>
                            <p class="text-gray-600 mb-4">Lower the cost of test for RF, mixed-signal, and MEMS devices.</p>
                            <a href="#" class="font-medium ni-text-blue hover:underline">Learn More &rarr;</a>
                        </div>
                    </div>
                    <!-- Solution 3 -->
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                        <div class="p-6">
                            <h3 class="text-xl font-semibold ni-text-blue mb-3">Wireless Research (6G)</h3>
                            <p class="text-gray-600 mb-4">Rapidly prototype and validate next-generation wireless systems.</p>
                            <a href="#" class="font-medium ni-text-blue hover:underline">Learn More &rarr;</a>
                        </div>
                    </div>
                    <!-- Solution 4 -->
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                        <div class="p-6">
                            <h3 class="text-xl font-semibold ni-text-blue mb-3">Autonomous Driving</h3>
                            <p class="text-gray-600 mb-4">Validate your ADAS and AD systems with open, data-driven test.</p>
                            <a href="#" class="font-medium ni-text-blue hover:underline">Learn More &rarr;</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Case Study Section (Personalized) -->
        <section class="py-16 bg-white">
            <div class="container mx-auto px-6 lg:px-8">
                <div class="flex flex-col md:flex-row items-center bg-gray-50 rounded-lg shadow-xl overflow-hidden">
                    <div class="w-full md:w-1/2">
                        <img src="https://placehold.co/600x400/003c71/9fcd3a?text=Major+Auto+OEM" alt="Automotive OEM" class="w-full h-full object-cover">
                    </div>
                    <div class="w-full md:w-1/2 p-8 md:p-12">
                        <h3 class="text-sm font-bold uppercase ni-text-green mb-2">Customer Success Story</h3>
                        <h2 class="text-3xl font-bold ni-text-dark-blue mb-4">How a Major Auto OEM Validates Battery Packs with NI</h2>
                        <p class="text-lg text-gray-700 mb-6">See how our PXI-based systems and regenerative cyclers helped a leading automaker reduce battery validation test time by 30% and accelerate their time-to-market.</p>
                        <a href="#" class="ni-bg-blue text-white font-bold py-3 px-6 rounded-full text-base hover:opacity-90 transition-opacity">
                            Read the Case Study
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Other NI Content -->
        <section class="py-16 ni-bg-light-gray">
            <div class="container mx-auto px-6 lg:px-8">
                <h2 class="text-3xl font-bold text-center ni-text-dark-blue mb-12">Explore Our Products</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Product 1 -->
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h3 class="text-xl font-semibold ni-text-blue mb-3">PXI Platform</h3>
                        <p class="text-gray-600">A modular, high-performance platform for automated test and measurement.</p>
                    </div>
                    <!-- Product 2 -->
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h3 class="text-xl font-semibold ni-text-blue mb-3">LabVIEW</h3>
                        <p class="text-gray-600">A graphical programming environment for test, measurement, and control.</p>
                    </div>
                    <!-- Product 3 -->
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h3 class="text-xl font-semibold ni-text-blue mb-3">TestStand</h3>
                        <p class="text-gray-600">Ready-to-run test management software for test sequence development.</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!--
      FOOTER: High-fidelity NI Footer
    -->
    <footer class="ni-bg-dark-blue text-white pt-16 pb-8">
        <div class="container mx-auto px-6 lg:px-8">
            <div class="grid grid-cols-2 md:grid-cols-5 gap-8">
                <!-- Column 1 -->
                <div>
                    <h4 class="font-bold text-lg mb-4">PRODUCTS</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="hover:underline">PXI</a></li>
                        <li><a href="#" class="hover:underline">LabVIEW</a></li>
                        <li><a href="#" class="hover:underline">TestStand</a></li>
                        <li><a href="#" class="hover:underline">Data Acquisition (DAQ)</a></li>
                        <li><a href="#" class="hover:underline">Software Defined Radios</a></li>
                    </ul>
                </div>
                <!-- Column 2 -->
                <div>
                    <h4 class="font-bold text-lg mb-4">INDUSTRIES</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="hover:underline">Aerospace and Defense</a></li>
                        <li><a href="#" class="hover:underline">Automotive</a></li>
                        <li><a href="#" class="hover:underline">Semiconductor</a></li>
                        <li><a href="#" class="hover:underline">Electronics</a></li>
                        <li><a href="#" class="hover:underline">Government</a></li>
                    </ul>
                </div>
                <!-- Column 3 -->
                <div>
                    <h4 class="font-bold text-lg mb-4">SUPPORT</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="hover:underline">Drivers</a></li>
                        <li><a href="#" class="hover:underline">Manuals</a></li>
                        <li><a href="#" class="hover:underline">Contact Support</a></li>
                        <li><a href="#" class="hover:underline">Product Lifecycle</a></li>
                    </ul>
                </div>
                <!-- Column 4 -->
                <div>
                    <h4 class="font-bold text-lg mb-4">COMPANY</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="hover:underline">About NI</a></li>
                        <li><a href="#" class="hover:underline">Careers</a></li>
                        <li><a href="#" class="hover:underline">Investor Relations</a></li>
                        <li><a href="#" class="hover:underline">Newsroom</a></li>
                    </ul>
                </div>
                <!-- Column 5 -->
                <div>
                    <h4 class="font-bold text-lg mb-4">NI Community</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="hover:underline">Discussion Forums</a></li>
                        <li><a href="#" class="hover:underline">NI Community Home</a></li>
                    </ul>
                </div>
            </div>
            <hr class="border-t border-gray-600 my-8">
            <div class="flex flex-col md:flex-row justify-between items-center text-sm text-gray-400">
                <div class="flex space-x-4 mb-4 md:mb-0">
                    <a href="#" class="hover:underline">Legal</a>
                    <a href="#" class="hover:underline">Privacy</a>
                    <a href="#" class="hover:underline">Cookie Policy</a>
                </div>
                <p>&copy; 2025 National Instruments. All rights reserved.</p>
            </div>
        </div>
    </footer>


    <!--
      STEP 3: Agentic Initiation Component
      This is the same pulsing button, now floating over the real page.
    -->
    <div id="solution-finder-trigger" class="fixed bottom-8 right-8 z-50">
        <button onclick="startDemo()" class="pulse-button ni-bg-green text-black font-bold py-4 px-6 rounded-full shadow-2xl text-lg flex items-center">
            <svg class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" /></svg>
            NI Solution Finder
        </button>
    </div>


    <!--
      STEP 4-8: Main Demo Container
      This is hidden by default and appears when the demo starts.
      THIS IS UNCHANGED.
    -->
    <div id="demo-container" class="hidden fixed inset-0 bg-black bg-opacity-50 z-[100]">
        <div class="flex h-full w-full items-center justify-center p-4">
            <div class="flex flex-col md:flex-row h-[90vh] w-full max-w-6xl bg-white rounded-xl shadow-2xl overflow-hidden relative">
                
                <!-- Left: Chat Panel -->
                <div class="w-full md:w-2/5 border-r border-gray-200 flex flex-col h-full">
                    <div class="p-4 border-b border-gray-200">
                        <h2 class="text-xl font-semibold ni-text-blue">NI Solution Finder</h2>
                        <p class="text-sm text-gray-600">Powered by NI-Trained Agent</p>
                    </div>
                    
                    <!-- Chat Messages -->
                    <div id="chat-messages" class="flex-1 p-4 space-y-4 overflow-y-auto flex flex-col">
                        <!-- Messages will be injected here by JS -->
                    </div>
                    
                    <!-- Chat Options -->
                    <div id="chat-options" class="p-4 bg-gray-50 border-t border-gray-200 flex flex-wrap justify-center">
                        <!-- Options will be injected here by JS -->
                    </div>
                </div>

                <!-- Right: Agentic Content Zone -->
                <div class="w-full md:w-3/5 h-full overflow-y-auto">
                    <div id="content-zone" class="p-6 sm:p-10">
                        <!-- Content will be injected here by JS -->
                    </div>
                </div>
                
                <!-- Close Button -->
                <button onclick="resetDemo()" class="absolute top-2 right-2 text-gray-600 hover:text-black z-10">
                    <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>

            </div>
        </div>
    </div>

    <!--
      DEMO JAVASCRIPT
      THIS IS UNCHANGED.
    -->
    <script>
        // --- Demo State Management ---
        const chatMessages = document.getElementById('chat-messages');
        const chatOptions = document.getElementById('chat-options');
        const contentZone = document.getElementById('content-zone');
        const heroHeadline = document.getElementById('hero-headline');
        const heroSubhead = document.getElementById('hero-subhead');

        // --- Content Templates ---

        function renderWelcomeContent() {
            return `
                <div class="animate-fade-in">
                    <h2 class="text-2xl font-bold ni-text-blue mb-4">Welcome, Raj.</h2>
                    <p class="text-lg text-gray-700 mb-6">Based on your interest in EV Battery Test, I can help you configure a complete solution.</p>
                    <div class="bg-gray-50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">How I can help:</h3>
                        <ul class="list-disc list-inside space-y-2 text-gray-600">
                            <li>Identify the right PXI hardware</li>
                            <li>Recommend compatible software</li>
                            <li>Find application notes and case studies</li>
                            <li>Connect you with a sales engineer</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        function renderProductCard(product) {
            const products = {
                cycler: {
                    title: 'HV-1200 Battery Cycler',
                    img: 'https://placehold.co/400x200/003c71/9fcd3a?text=HV-1200+Cycler',
                    specs: [
                        { label: 'Voltage', value: 'Up to 1200 V' },
                        { label: 'Current', value: 'Up to 600 A' },
                        { label: 'Channels', value: '1-4 per module' }
                    ],
                    desc: 'A high-power, regenerative cycler for validating high-voltage battery packs.'
                },
                labview: {
                    title: 'LabVIEW + BTS Software',
                    img: 'https://placehold.co/400x200/003c71/9fcd3a?text=LabVIEW+BTS',
                    specs: [
                        { label: 'Control', value: 'Full hardware automation' },
                        { label: 'Test Steps', value: 'Pre-built sequences' },
                        { label: 'Data', value: 'Integrated data logging' }
                    ],
                    desc: 'The software add-on for controlling hardware and automating lifecycle test sequences.'
                }
            };
            
            const p = products[product];
            if (!p) return '';

            return `
                <div class="bg-white rounded-lg shadow-lg overflow-hidden border border-gray-200 animate-fade-in mb-6">
                    <img src="${p.img}" alt="${p.title}" class="w-full h-40 object-cover">
                    <div class="p-5">
                        <h3 class="text-xl font-bold ni-text-blue mb-3">${p.title}</h3>
                        <p class="text-gray-600 mb-4">${p.desc}</p>
                        <div class="grid grid-cols-3 gap-4 text-center">
                            ${p.specs.map(spec => `
                                <div>
                                    <span class="text-sm text-gray-500">${spec.label}</span>
                                    <p class="text-md font-semibold text-gray-900">${spec.value}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }
        
        function renderMeetingForm() {
            return `
                <div class="animate-fade-in">
                    <h2 class="text-2xl font-bold ni-text-blue mb-4">Schedule Consultation</h2>
                    <p class="text-gray-700 mb-6">Please confirm your details to book a 15-minute call with a technical sales engineer.</p>
                    <div class="space-y-4">
                        <div>
                            <label for="name" class="block text-sm font-medium text-gray-700">Full Name</label>
                            <input type="text" id="name" value="Raj Singh" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 bg-gray-100" readonly>
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                            <input type="email" id="email" value="raj.singh@tier1-auto.com" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 bg-gray-100" readonly>
                        </div>
                        <div>
                            <label for="company" class="block text-sm font-medium text-gray-700">Company</label>
                            <input type="text" id="company" value="Tier 1 Automotive Supplier" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 bg-gray-100" readonly>
                        </div>
                        <!-- Fake calendar slot -->
                        <div class="bg-blue-50 border border-blue-200 rounded-md p-4">
                            <p class="font-semibold text-blue-800">Selected Time:</p>
                            <p class="text-blue-700">Tomorrow, October 23rd @ 10:30 AM CDT</p>
                        </div>
                        <button onclick="handleOption(8)" class="w-full ni-bg-green text-black font-bold py-3 px-4 rounded-lg shadow-md hover:opacity-90 transition-opacity">
                            Confirm Meeting
                        </button>
                    </div>
                </div>
            `;
        }

        // --- Demo Flow Logic ---
        
        function startDemo() {
            // Don't hide the main content, just show the modal over it
            document.getElementById('solution-finder-trigger').classList.add('hidden');
            document.getElementById('demo-container').classList.remove('hidden');
            
            runStep(1);
        }
        
        function resetDemo() {
            // Hide the modal and show the button again
            document.getElementById('demo-container').classList.add('hidden');
            document.getElementById('solution-finder-trigger').classList.remove('hidden');
            
            // Clear the demo state
            chatMessages.innerHTML = '';
            chatOptions.innerHTML = '';
            contentZone.innerHTML = '';
            
            // Reset the hero to its personalized state
            heroHeadline.textContent = 'Accelerate Your EV Battery Validation';
            heroSubhead.textContent = 'Design and deploy comprehensive test systems for every stage of the battery lifecycle, from R&D to production.';
        }

        function addAgentMessage(text) {
            const msg = document.createElement('div');
            msg.className = 'chat-bubble chat-bubble-agent';
            msg.innerHTML = text;
            chatMessages.appendChild(msg);
            scrollToBottom();
        }

        function addUserMessage(text) {
            const msg = document.createElement('div');
            msg.className = 'chat-bubble chat-bubble-user';
            msg.innerHTML = text;
            chatMessages.appendChild(msg);
            scrollToBottom();
        }

        function showOptions(options) {
            chatOptions.innerHTML = ''; // Clear old options
            options.forEach(option => {
                const btn = document.createElement('button');
                btn.className = 'chat-option';
                btn.innerHTML = option.text;
                btn.onclick = () => handleOption(option.nextStep);
                chatOptions.appendChild(btn);
            });
        }
        
        function handleOption(nextStep) {
            // Get the text of the button that was clicked
            const userText = event.target.innerHTML;
            addUserMessage(userText);
            
            // Disable options after selection
            chatOptions.innerHTML = '<p class="text-sm text-gray-500 italic">Thinking...</p>';
            
            // Run the next step after a short delay
            setTimeout(() => {
                runStep(nextStep);
            }, 1200);
        }
        
        function scrollToBottom() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // The main demo "script"
        function runStep(step) {
            switch (step) {
                case 1: // Agent Intro
                    addAgentMessage("Hi! I see you're exploring our EV battery test solutions. I'm an NI-trained agent and can help configure a system.");
                    contentZone.innerHTML = renderWelcomeContent();
                    
                    setTimeout(() => {
                        addAgentMessage("What's your primary challenge: performance validation, lifecycle testing, or end-of-line manufacturing?");
                        showOptions([
                            { text: 'Performance Validation', nextStep: 2 },
                            { text: 'Lifecycle Testing', nextStep: 2 },
                            { text: 'End-of-Line Manufacturing', nextStep: 2 }
                        ]);
                    }, 1500);
                    break;
                
                case 2: // User chooses "Lifecycle Testing" -> Agent responds
                    addAgentMessage("Understood. Lifecycle validation is a core strength. Our PXI-based systems are the industry standard for this.");
                    
                    setTimeout(() => {
                        addAgentMessage("Based on your goal, I can pull up specifications for our <strong>High-Voltage Battery Cycler</strong>, or would you prefer to see an <strong>application note</strong> on 'Simulating Real-World Driving Profiles'?");
                        showOptions([
                            { text: 'Show Cycler Specs', nextStep: 3 },
                            { text: 'Show Application Note', nextStep: 3 }
                        ]);
                    }, 1500);
                    break;
                    
                case 3: // User chooses "Show Cycler Specs" -> Agent delivers content
                    addAgentMessage("Here are the key specifications for the HV-1200 Battery Cycler. I've populated the content panel on your right with more details, including compatible chassis and software.");
                    contentZone.innerHTML = renderProductCard('cycler');
                    
                    // Auto-trigger next logical question
                    setTimeout(() => {
                        showOptions([
                            { text: 'What software do I use for this?', nextStep: 4 }
                        ]);
                    }, 2000);
                    break;
                
                case 4: // User asks about software -> Agent delivers content
                    addAgentMessage("Great question. Most engineers pair this hardware with our <strong>LabVIEW</strong> software and the <strong>Battery Test System (BTS) Software Add-On</strong>.");
                    
                    setTimeout(() => {
                        addAgentMessage("It provides pre-built test sequences and simplifies data logging. I've added the software details to your content panel.");
                        // Append the new card, "building" the solution
                        contentZone.innerHTML += renderProductCard('labview');
                    }, 1500);
                    
                    // Auto-trigger next logical step
                    setTimeout(() => {
                        showOptions([
                            { text: 'This is complex, I need to talk to someone.', nextStep: 5 }
                        ]);
                    }, 3000);
                    break;
                    
                case 5: // User asks for sales -> Agent shows calendar
                    addAgentMessage("I can help with that. Connecting you with a technical sales engineer is the best next step. They can help design your full test rack.");
                    
                    setTimeout(() => {
                        addAgentMessage("Would you like to schedule a 15-minute virtual consultation now?");
                        // Update content zone with calendar/form
                        contentZone.innerHTML = renderMeetingForm();
                        // Clear options, as the next step is in the content-zone
                        chatOptions.innerHTML = ''; 
                    }, 1500);
                    break;
                    
                case 8: // User "clicks" confirm in the form
                    // This step is triggered by the button in renderMeetingForm()
                    // The addUserMessage was already handled by the button's handleOption()
                    addUserMessage("<em>[Confirmed Meeting Details]</em>");
                    addAgentMessage("Your consultation is confirmed! A calendar invite has been sent to <strong>raj.singh@tier1-auto.com</strong>.");
                    contentZone.innerHTML = `
                        <div class="text-center p-10 animate-fade-in">
                            <svg class="h-16 w-16 ni-text-green mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                            <h2 class="text-2xl font-bold ni-text-blue mb-2">Thank You!</h2>
                            <p class="text-lg text-gray-700">Your meeting is set. All of our conversation notes and the products we discussed have been sent to the sales engineer.</p>
                        </div>
                    `;
                    
                    setTimeout(() => {
                        addAgentMessage("When you return to ni.com, I'll remember where we left off. You can click the 'X' to close this window.");
                        chatOptions.innerHTML = '<button onclick="resetDemo()" class="chat-option bg-gray-200">Reset Demo</button>';
                    }, 1500);
                    break;
            }
        }
        
        // Add a class for fade-in animation
        const styleSheet = document.createElement("style");
        styleSheet.type = "text/css";
        styleSheet.innerText = `
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            .animate-fade-in {
                animation: fadeIn 0.5s ease-out;
            }
        `;
        document.head.appendChild(styleSheet);
        
        // --- Page Personalization Logic ---
        // This function will run on page load to set the personalized content
        function initializePersonalization() {
            // In a real demo, this data would come from Data Cloud
            const userProfile = {
                name: "Raj",
                industry: "Automotive",
                interest: "EV Battery Test"
            };

            // Personalize Hero
            heroHeadline.textContent = 'Accelerate Your EV Battery Validation';
            heroSubhead.textContent = 'Design and deploy comprehensive test systems for every stage of the battery lifecycle, from R&D to production.';
            
            // In a real app, we would also swap the case studies and solution blocks.
            // For this hard-coded demo, they are already set to the "personalized" state.
        }

        // Run personalization when the page loads
        document.addEventListener('DOMContentLoaded', initializePersonalization);
        
    </script>
</body>
</html>

